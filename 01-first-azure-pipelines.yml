# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml
#
trigger:
- main

pool:
  vmImage: ubuntu-latest

stages:
- stage: Build
  jobs:
  - job: BuildApp
    steps:
    - script: mvn clean package
      displayName: "Build the Spring Boot App"

- stage: Deploy
  dependsOn: Build
  jobs:
  - job: DeployInfra
    steps:
    - script: terraform apply -auto-approve
      displayName: "Deploy Infra with Terraform"

  - job: DeployApp
    dependsOn: DeployInfra
    steps:
    - script: echo "Deploying Spring Boot App..."
      displayName: "Deploy App"





